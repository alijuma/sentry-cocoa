name: iOS-Swift_xcodegen
configs:
  Debug: debug
  Test: debug
  TestCI: debug
  Release: release
projectReferences:
  Sentry:
    path: ../Sentry.xcodeproj
fileGroups:
  - Shared/Config
  - iOS-Swift.yml
options:
  bundleIdPrefix: io.sentry
targets:
  iOS-Swift:
    type: application
    platform: auto
    sources:
      - iOS-Swift/iOS-Swift
      - Shared/GitInjections.swift
      - Shared/DSNStorage.swift
      - Shared/screenshot.png
      - Shared/SampleAssets.xcassets
    dependencies:
      - target: Sentry/Sentry
      - target: iOS-SwiftClip
    configFiles:
      Debug: iOS-Swift.xcconfig
      Release: iOS-Swift.xcconfig
      Test: iOS-Swift.xcconfig
      TestCI: iOS-Swift.xcconfig
    postCompileScripts:
      - script: Shared/inject-git-info.sh
        name: Inject Git Information into Info.plist
        basedOnDependencyAnalysis: false
    postBuildScripts:
      - script: Shared/reset-git-info.sh
        name: Reset Git Fields in Info.plist
        basedOnDependencyAnalysis: false
  iOS-SwiftClip:
    type: application.on-demand-install-capable
    platform: auto
    sources:
      - iOS-Swift/iOS-SwiftClip
      - Shared/GitInjections.swift
      - Shared/DSNStorage.swift
      - Shared/screenshot.png
    dependencies:
      - target: Sentry/Sentry
    configFiles:
      Debug: iOS-SwiftClip.xcconfig
      Release: iOS-SwiftClip.xcconfig
      Test: iOS-SwiftClip.xcconfig
      TestCI: iOS-SwiftClip.xcconfig
    postCompileScripts:
      - script: Shared/inject-git-info.sh
        name: Inject Git Information into Info.plist
        basedOnDependencyAnalysis: false
    postBuildScripts:
      - script: Shared/reset-git-info.sh
        name: Reset Git Fields in Info.plist
        basedOnDependencyAnalysis: false
  iOS-Swift-UITests:
    type: bundle.ui-testing
    platform: auto
    sources:
      - iOS-Swift/iOS-Swift-UITests
    configFiles:
      Debug: iOS-Swift-UITests.xcconfig
      Release: iOS-Swift-UITests.xcconfig
      Test: iOS-Swift-UITests.xcconfig
      TestCI: iOS-Swift-UITests.xcconfig
  iOS-Benchmarking:
    type: bundle.ui-testing
    platform: auto
    sources:
      - iOS-Swift/iOS-Benchmarking
    configFiles:
      Debug: iOS-Benchmarking.xcconfig
      Release: iOS-Benchmarking.xcconfig
      Test: iOS-Benchmarking.xcconfig
      TestCI: iOS-Benchmarking.xcconfig
schemes:
  iOS-Swift:
    build:
      targets:
        iOS-Swift: all
        iOS-SwiftClip: all
        iOS-Swift-UITests: test
        iOS-Benchmarking: test
    test:
      targets:
        - iOS-Swift-UITests
      config: Test
      deleteScreenshotsWhenEachTestSucceeds: false
  iOS-Benchmarking:
    build:
      targets:
        iOS-Swift: test
        iOS-SwiftClip: test
        iOS-Benchmarking: test
    test:
      targets:
        - iOS-Benchmarking
      config: Release
